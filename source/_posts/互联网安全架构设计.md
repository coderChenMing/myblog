---
title: 互联网安全架构设计
date: 2020-01-08 13:46:29
updated: 2020-01-08 14:16:21
tags: web安全
categories: 架构设计
---
## 目的
    1.避免代码被攻击
    2.如何做到项目安全保障
## 项目安全隐患
    1.代码
    2.业务逻辑
    3.应用

## web安全常用攻击手段
    xss
    sql注入
    防盗链
    CSRF
    上传漏洞
## 什么是XSS攻击?
    XSS攻击使用Javascript脚本注入进行攻击,比如通过javascript脚本,获取用户信息,比如会话信息
    原因: 浏览器支持js,展示内容带有js脚本时会执行
    风险:获取用户数据,伪造请求完成相关攻击操作
    eg: 在一个页面提交表单后，到另一个页面展示，可能会受到XSS脚本注入，读取本地cookie远程发送给黑客服务器端。
    eg: 点击一个连接，链接中包含用户信息，被第三方拦截，添加js脚本，跳转到钓鱼网站，用户未能识别钓鱼网站而被骗
    测试脚本:
    <script>alert('sss')</script>
    <script>window.location.href='http://www.baidu.com';</script>
## 如何防御XSS攻击?
    将脚本特殊字符，转换成html源代码进行展示。比如< 在html想展示,转为&lt;
    测试脚本处理后对应html源代码: &lt;script&gt;alert('sss')&lt;/script&gt;
## sql注入
    根据sql语法,输入相关字符,改变原sql形成攻击sql
    如:mybatis 中$符号拼接sql时需要程序员添加',这里当攻击者通过'的技巧输入形成新sql,从而直接对MYSQL进行数据攻击
    eg: select username,password from user where user='${username}' and password='${password}';
    当攻击url: http://ip:port/find?username=zhangsan&password='or 1= '1
    形成攻击sql:select username,password from user where user='zhangsan' and password='' or 1 ='1';
    后果: 可完成查询所有用户数据,用户数据泄露
## 如何防御sql攻击
    1.编写dao层尽量不要使用sql拼接,使用预编译方式,比如mybatis中的#替换$
    2.如果使用了sql拼接,要对入参含有特殊字符进行处理
## MyBatis #与$区别
    #{}: 解析为一个 JDBC 预编译语句（prepared statement）的参数标记符，一个 #{} 被解析为一个参数占位符,可以防止SQL注入问题。
    ${}: 仅仅为一个纯碎的 string 替换，在动态 SQL 解析阶段将会进行变量替换。